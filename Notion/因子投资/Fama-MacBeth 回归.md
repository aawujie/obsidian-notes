---
notion-id: 2ba78d23-e296-80e5-b6fb-da7ee61734cc
base: "[[因子投资.base]]"
cover: "[[Fama-MacBeth 回归.jpeg]]"
Last edited time: 2026-02-11T18:41:00
Tags: []
Verification: unverified
Owner:
  - 杰 吴
---
[https://www.bilibili.com/video/BV1Py4y1j7x5/?spm_id_from=333.337.search-card.all.click&vd_source=fdf204514e682cfd0d820e88a84bbe31](https://www.bilibili.com/video/BV1Py4y1j7x5/?spm_id_from=333.337.search-card.all.click&vd_source=fdf204514e682cfd0d820e88a84bbe31)

> “两步法线性截面回归”（Two-Pass Cross-Sectional Regression）

## 背景

OLS（Ordinary Least Squares, OLS）普通最小二乘线性回归：

- 用一条直线去最好地拟合散点图，使所有点到这条直线的“垂直距离平方和”最小。
- 下月收益 = α + β × 市值 + ε → β 就是我们最关心的“斜率”（市值每变 1，收益变多少）

## 为什么要用 Fama-MacBeth

股票数据天然存在两大问题：

- **截面相关**：**同一个月，所有股票的残差几乎同方向**（市场因子、行业因子等）
- **时间序列相关**：**同一只股票不同月份残差也相关**

普通 pooled OLS、固定效应、甚至单向聚类都会**严重低估标准误 **→ t 值爆炸 → 假显著。

Fama-MacBeth（1973）完美解决：

**先每月做截面回归 → 把共同冲击压缩进当月系数 → 最后只用“时间序列”算标准误**

等价于**“按时间聚类”**的标准误差，但更直观、更容易加控制变量。

## 标准模型

下个月收益 = 当月底薪 + 你的特征奖励 + 市值惩罚/奖励 + 行业奖励 + 运气

$$
r_{i,t+1} = λ_t + γ_t f_{i,t} + β_t Size_{i,t} + ∑ γ_{j,t} Industry_{j,i,t} + ε_{i,t+1}
$$

其中：

- $r_{i,t+1}$: 股票 i 在 t+1 月的超额收益率
- $λ_t$: **当月收益**
- $γ_t$: 因子**收益率，奖励力度**
- $f_{i,t}$: 你关心的**特征**（Size, Value, Momentum, Turnover, Illiquidity, Beta, Skewness…）
- $β_t$: 当月**市值效应**的斜率 (这个月，大股票和小股票的收益率到底差多少)
    - β_t > 0：说明这个月大市值股票表现更好（大盘股吃香）
    - β_t < 0：说明这个月小市值股票表现更好（小盘股吃香）
    - β_t ≈ 0：这个月市值大小不重要
- $Size_{i,t}$: **ln(流通市值) 或 ln(总市值)**
- $∑ γ_j,t × Industry_j(i,t)$: 行业固定效应
    - $γ_{j,t}$: 第 t 个月，行业 j 的 **“额外收益” 或者 “行业溢价”**。
    - $Industry_{j,i,t}$: 行业 j 的哑变量，**纯粹的 0/1 开关**。
    - 这个月每个行业额外多赚（或少赚）多少钱。比如这个月银行股集体狂飙，银行行业的 $γ_j,t$ 就是正的。
- $ε(i,t+1)$: 残差，上面都解释不了的“运气成分”（ε 永远存在，它是“上帝掷骰子”那部分）
    - 真实收益 = 模型能解释的部分 + **模型解释不了的部分（ε）**。
    - 它永远存在、永远为 0（平均意义下）、永远不能完全消除。

### Q&A

1. 实际中国A股样本里，$β_t$ 几乎每个月都是负的（平均大概 -0.3% 到 -0.8% 左右），意思就是：
“**每个月小股票平均比大股票表现好 0.3%~0.8%**” ——这就是经典的“中国A股小市值效应”。

2. 什么叫哑变量？
**哑变量 = 0/1 开关，只有属于这个行业的股票才打开开关，吃到这个行业的额外收益。**
假设现在有 5 个行业：银行、地产、白酒、光伏、科技
我们给每一只股票都造 5 个新列，用 0 和 1 表示它属于哪个行业，这 5 列就叫“行业哑变量”。

| 股票 | 是银行 | 是地产 | 是白酒 | 是光伏 | 是科技 |
| --- | --- | --- | --- | --- | --- |
| 招商银行 | 1 | 0 | 0 | 0 | 0 |
| 万科 | 0 | 1 | 0 | 0 | 0 |
| 茅台 | 0 | 0 | 1 | 0 | 0 |
| 隆基 | 0 | 0 | 0 | 1 | 0 |
| 宁德时代 | 0 | 0 | 0 | 0 | 1 |
3. 风险价格（price of risk）
$γ_t$ 就是 “当月市场上为扛一单位这种风险实际付了多少钱。把所有月份的 $γ_t$ 取平均 $γ̄$，就得到 “长期平均每扛一单位风险，市场每个月给你多少回报”。这笔长期稳定的报酬率，正是教科书里 “风险的价格”。

4. beta 通常采用滚动窗口（常为 60 个月，最少不低于 36 个月）逐月更新，而不是全样本一次性估计。

5. 常见变种
| 版本 | 第一步 beta | 第二步被解释变量 | 适用场景 |
| --- | --- | --- | --- |
| 经典 FM (1973) | 全样本 | 当月回报 | 早期研究 |
| 滚动 FM（主流） | 过去 36–60 月滚动估计 | 当月回报 | 目前 99% 论文 |
| Fama-French (1992) | 全样本 | 当月回报 | 构造因子时常用 |
| Portfolio-level FM | 25/49 组合排序后跑 | 组合当月回报 | 减少 EIV 偏差 |

## Fama-MacBeth 两步法完整流程

**第一步：每月截面回归**

- 对每个月 t = 1, 2, …, T（通常 T ≥ 60，最好 120+）分别跑上面的回归，
- 得到 T 个 $γ_t$（以及 $λ_t$、$β_t$ 等）

**第二步：时间序列平均**

- 最终报告的因子收益（风险价格） $γ̄ = (1/T) × Σ γ_t$

**Standard Error of Fama-MacBeth (Fama-MacBeth 标准误差)**

- 120 个月的平均值：这个因子每月到底赚多少钱

$$
γ̄ = (1/T) Σ γ_t
$$

- 真实误差：120个 $γ$ 自己跳来跳去的幅度，除以$√120$ 。因为看了120个月，信息量多了$√120$倍

$$
SE_FM = std({γ₁, γ₂, …, γ_T}) / √T
$$

- 最终显著性：平均赚的钱 ÷ 真实误差（t > 1.96 显著，t > 3 顶刊爱看，t > 5 直接上 JF）

$$
t-stat = γ̄ / SE_FM
$$

### Q&A

- t-stat 就是 t-statistic 的缩写，中文叫 **t 统计量**（金融圈也直接叫 t 值）。
- 在金融论文里你会看到这几种写法完全混着用：

| 写法          | 例子                 | 常见场景          |
| ----------- | ------------------ | ------------- |
| t-stat      | t-stat = 3.28      | 顶刊最常见（JF、JFE） |
| t-value     | t-value = 3.28     | 稍微正式一点        |
| t-statistic | t-statistic = 3.28 | 教科书最标准写法      |
| t           | (3.28)             | 表格里最省地方的写法    |
- 一句话记死：
t-stat 就是那个决定你因子**“显著还是不显著”的关键数字**，
**t-stat  = 平均收益 ÷ 最诚实的标准误（SE_FM）**
- |t-stat| > 1.96 → 10% 水平显著（一般不认）
- |t-stat| > 2.58 → 1% 水平显著（国内顶刊最低要求）
- |t-stat| > 3.00 → 顶刊真正开始心动
- |t-stat| > 5 → 直接 JF/RFS 一作

## 手算示例

| 月 | 股票 | 下月收益 | 特征f | ln市值 | 行业 |
| --- | --- | --- | --- | --- | --- |
| 1 | A | 0.05 | 0.30 | 7.2 | 银行 |
| 1 | B | 0.03 | 0.15 | 6.8 | 银行 |
| 1 | C | -0.01 | -0.20 | 5.5 | 制造 |
| 2 | A | 0.08 | 0.35 | 7.3 | 银行 |
| … | … | … | … | … | … |

每月回归后得到的 $γ_t$（特征 f 的系数）：

- 月1：γ₁ = 0.112
- 月2：γ₂ = 0.138
- 月3：γ₃ = 0.095

最终：每月平均多赚 1.15%，

$$
γ̄ = (0.112 + 0.138 + 0.095)/3 = 0.115    
$$

$$
std(γ_t) ≈ 0.022
$$

$$
SE_FM = 0.022 / √3 ≈ 0.0127
$$

$$
t = 0.115 / 0.0127 ≈ 9.05
$$