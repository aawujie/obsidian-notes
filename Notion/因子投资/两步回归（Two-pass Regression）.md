---
share_link: https://share.note.sx/vfczmxip#YESEJQG2FF8ov1O1eAp8AApGm1g7hxY/nL7CXa19buM
share_updated: 2026-02-16T00:49:50+08:00
---
## 1. 什么是两步回归 (Two-pass Regression)？

它是实证资产定价中检验多因子模型（如 Fama-French 三因子）的**标准工作流**。

*   **核心目标**：检验因子是否被市场 “定价”（即：承担了因子的风险，是否真的能带来超额收益？）。
*   **逻辑拆解**：
    *   **第一步（纵向）**：估算风险暴露（$\beta$）。
    *   **第二步（横向）**：估算风险溢价（$\lambda$）。

---

## 2. 详细流程拆解

### 第一步：时间序列回归 (Time-Series Regression)

**“给资产贴标签”**

*   **动作**：对每一个资产 $i$，用它过去 $T$ 个月的历史收益率，对因子收益率做回归。
*   **公式**：
    $$ R_{i,t} = a_i + \beta_i f_t + \epsilon_{i,t} $$
*   **产出**：得到每个资产的 **因子载荷 $\hat{\beta}_i$**。
    *   *比如：算出股票 A 的市值因子 $\beta$ 是 1.2（小盘股属性强），股票 B 是 -0.5（大盘股属性强）。*

### 第二步：截面回归 (Cross-Sectional Regression)

**“看标签值多少钱”**

*   **动作**：把所有资产放在一起（横截面）。用资产的**平均收益率** ($\bar{R}_i$) 作为因变量，用第一步算出来的 **$\hat{\beta}_i$** 作为自变量，做回归。
*   **公式**：
    $$ \bar{R}_i = \gamma + \hat{\beta}_i \lambda + \alpha_i $$
*   **产出**：
    1.  **因子溢价 $\hat{\lambda}$**（斜率）：代表每承担一单位风险，市场给多少回报。
    2.  **定价误差 $\alpha_i$**（残差）：模型解释不了的部分。

---

## 3. 两步回归与 GLS 的关系：GLS 是第二步的 “升级包”

在执行**第二步（截面回归）**时，你面临两种选择：**OLS（普通版）** 或 **GLS（尊贵版）**。

### (1) 基础版：OLS 两步回归

*   **做法**：直接用最小二乘法回归，假设所有股票地位平等。
*   **假设**：认为定价误差 $\alpha_i$ 互不相关，且方差相同。
*   **缺点**：**无视了现实的复杂性**。
    *   现实中，地产股和银行股的残差可能高度相关（行业联动）；小盘股的波动率远大于大盘股（异方差）。OLS 忽略了这些，导致算出的 $\lambda$ 精度不高。

### (2) 进阶版：GLS 两步回归

*   **做法**：引入**残差协方差矩阵 $\boldsymbol{\Sigma}$** 进行加权回归。
*   **公式**：
    $$ \hat{\lambda}_{GLS} = (\hat{\beta}' \boldsymbol{\Sigma}^{-1} \hat{\beta})^{-1} \hat{\beta}' \boldsymbol{\Sigma}^{-1} \bar{R} $$
*   **核心逻辑（加权）**：
    *   **$\boldsymbol{\Sigma}^{-1}$ (逆矩阵)** 起到了“过滤器”的作用。
    *   它会**降低**那些波动率大（噪声多）或抱团严重（信息重复）的股票的权重。
    *   它会**提升**那些走势独立、波动率小的股票的权重。
*   **优点**：在统计学上，GLS 提供的估计是**“最有效的” (Most Efficient)**，即在相同样本下，它的估计误差最小。

---

## 4. 关键技术细节（防坑指南）

无论你第二步选 OLS 还是 GLS，只要用了两步回归，就必须面对一个致命缺陷：

### 变量误差问题 (Errors-in-Variables, EIV)

*   **问题**：第二步用到的自变量 $\hat{\beta}$ 不是上帝给的真值，而是第一步“估算”出来的，本身就带有误差。
*   **后果**：这会导致第二步算出的 $\lambda$ 的 $t$ 值虚高（把假因子当成真因子）。
*   **解决方案**：必须使用 **Shanken 修正 (Shanken Correction)**。
    *   它会给标准误乘上一个系数（通常大于 1），把 $t$ 值降下来，让检验更严格。
    *   **结论**：**做两步回归，必须搭配 Shanken 修正。**

---

## 5. 总结对比表

| 维度 | **OLS 两步回归** | **GLS 两步回归** |
| :--- | :--- | :--- |
| **第一步 (时序)** | 算 $\beta$ (完全一样) | 算 $\beta$ (完全一样) |
| **第二步 (截面)** | **普通最小二乘** | **广义最小二乘** |
| **对待资产的态度** | 一视同仁，权重相等 | **看人下菜碟**，加权处理 |
| **所需数据** | 仅需收益率和 $\beta$ | 需要额外的**协方差矩阵 $\Sigma$** |
| **计算难度** | 简单 | 困难 (大矩阵求逆不稳定) |
| **统计性质** | 无偏，但不够有效 | **最有效 (BLUE)** |
| **必须修正** | 需要 Shanken 修正 | 需要 Shanken 修正 |

---

### 💡 一句话记忆

**两步回归是“战略路线图”（先算 $\beta$ 再算 $\lambda$）；而 GLS 是第二步战役中的“精密制导武器”，它利用协方差矩阵解决了股票间乱动和抱团的问题，比 OLS 的“地毯式轰炸”更精准。**