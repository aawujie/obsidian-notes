# GRS 检验与均值-方差张成

> 《因子投资：方法与实践》第 2.5 节

---

## 预备知识：先搞清楚我们在问什么

### 背景问题

假设你有一套**因子模型**（如 Fama-French 三因子：市场、规模、价值），用来解释股票收益。现在有一批**新资产**（如某类基金、另类因子组合等），你想问：

> **这套因子模型，能不能「解释」或「定价」这些新资产？**

GRS 和 Spanning 检验，就是在回答这个问题。

---

### 预备 1：风险-收益平面

- **横轴 σ**：组合波动率（风险）
- **纵轴 μ**：组合期望收益

投资者在「风险-收益」平面上做选择：希望**高收益、低风险**，即越往**左上**越好。

---

### 预备 2：因子 vs 资产

- **因子** $R_1$：解释收益的「风险源」（如市场超额收益、SMB、HML）
- **待测资产** $R_2$：你想检验能否被因子解释的资产

回归 $R_2 = \alpha + \beta R_1 + \varepsilon$ 的含义：

- **$\beta R_1$**：收益中能被因子解释的部分
- **$\alpha$**：因子解释不了的「超额收益」（定价误差）
- **$\varepsilon$**：随机噪音

**模型定价正确** ⟺ $\alpha = 0$（没有系统性定价误差）

---

### 预备 3：有效前沿 = 最优边界

给定一组资产，通过**线性组合**可以构造无数个组合。其中，**给定风险下收益最高**的那些组合，连成一条曲线，叫**有效前沿**。

- 前沿**以内**：能达到，但非最优
- 前沿**以外**：用现有资产达不到
- 加入新资产后，前沿可能**不变**（新资产无增量）或**向外扩张**（新资产有增量）

---

### 预备 4：本笔记要解决的问题

| 检验 | 核心问题 |
|:-----|:---------|
| **GRS** | 加入新资产后，**切点组合的夏普比**是否显著提升？（假设有无风险利率） |
| **Spanning** | 加入新资产后，**整条有效前沿**是否发生位移？（不假设无风险利率） |

两者都在问：**新资产有没有独立于因子的价值？**

---

## 1. 有效前沿 (Efficient Frontier) 是什么？

在横轴为风险 $\sigma$、纵轴为期望收益 $\mu$ 的图中：

- **可行集**：所有资产及其线性组合对应的 $(\sigma, \mu)$ 点
- **有效前沿**：在可行集中，**给定风险下收益最高**（或给定收益下风险最低）的组合形成的曲线

前沿 = 用现有资产能画出的「最优风险-收益边界」。

### 图注：新旧前沿对比（不能张成的情形）

![[frontier_comparison.png]]

**如何读这张图：**

| 图元 | 含义 |
|:-----|:-----|
| 横轴 σ | 组合风险（波动率） |
| 纵轴 μ | 组合期望收益 |
| **蓝线** | 旧前沿：只用 K 个因子能构造的最优边界 |
| **红线** | 新前沿：加入 N 个资产后能构造的最优边界 |
| **红色阴影** | 新资产带来的「增量区域」——之前达不到的风险-收益组合 |

**直观理解：**

- 红线在蓝线**外侧**（左上方）→ 同样风险下收益更高，或同样收益下风险更低
- 红色阴影 = 投资者「新获得」的更好选择
- 若**能张成**：蓝线红线会重合，没有阴影；本图展示的是**不能张成**，故前沿向外扩张

---

## 2. 张成 (Spanning) 从哪来？

### 2.1 线性代数里的 span

一组向量**张成**一个空间 = 该空间内任意向量都可写成这组向量的**线性组合**。

### 2.2 资产定价里的张成

- **旧资产**：$K$ 个因子 $R_1$
- **新资产**：$N$ 个待测资产 $R_2$

**「$R_1$ 张成 $R_2$」** = $R_2$ 的收益结构可以**完全**由 $R_1$ 的线性组合得到，没有多出来的东西。

### 2.3 回归形式

$$R_{2,t} = \alpha + \beta R_{1,t} + \varepsilon_t$$

**张成的数学条件**（原假设 $H_0$）：

1. **$\alpha = 0$**：没有超额收益，收益完全由因子解释
2. **$\delta = \mathbf{1} - \beta \mathbf{1}_K = 0$**：权重和为 1，不改变「总风险暴露」结构

满足这两条 ⟹ $R_2$ 在收益结构上可以被 $R_1$ 的线性组合「复制」。

### 2.4 概念链条

![[spanning_concept_flow.png]]

```
线性代数：span = 线性组合能覆盖的空间
    ↓
资产定价：R₂ 能否被 R₁ 的线性组合「复制」？
    ↓
回归：α=0 且 δ=0 ⟺ R₁ 张成 R₂
    ↓
组合优化：张成 ⟺ 加入 R₂ 不改变有效前沿
    ↓
检验：比较旧前沿 vs 新前沿 → Spanning 检验
```

---

## 3. 张成与前沿的关系

| 情况 | 含义 | 前沿 |
|:-----|:-----|:-----|
| **能张成** | 旧因子可完美替代新资产 | 前沿**不变** |
| **不能张成** | 新资产有独立价值 | 前沿**向外扩张** |

**一句话**：张成 = 新资产不改变前沿；不能张成 = 新资产让前沿向外扩张。

---

## 4. GRS 检验 vs Spanning 检验

| 维度 | GRS 检验 | Spanning 检验 |
|:-----|:---------|:--------------|
| **假设** | 存在无风险利率 $R_f$ | 不假设 $R_f$ |
| **关注点** | 切点组合的夏普比 | 整条有效前沿抛物线 |
| **几何** | $\sigma=1$ 处 OA vs OB | 左端 OD/OC，右端 AH/BF |
| **统计量** | $F(N, T-N-K)$ | LR / Wald / LM |

### 4.1 GRS 检验（公式 2.16 & 2.68）

**矩阵形式**：
$$GRS = \left( \frac{T - N - K}{N} \right) \left( 1 + \bar{\boldsymbol{\lambda}}' \hat{\boldsymbol{\Sigma}}_f^{-1} \bar{\boldsymbol{\lambda}} \right)^{-1} \hat{\boldsymbol{\alpha}}' \hat{\boldsymbol{\Sigma}}^{-1} \hat{\boldsymbol{\alpha}} \sim F(N, T - N - K)$$

**几何形式**：
$$GRS = \frac{T - N - K}{N} \cdot \left( \frac{1 + \hat{\theta}_{N+K}^2}{1 + \hat{\theta}_K^2} - 1 \right)$$

- $\hat{\theta}_K$：仅 K 个因子的最大夏普比
- $\hat{\theta}_{N+K}$：加入 N 个资产后的最大夏普比
- **几何意义**：在 $\sigma=1$ 处，旧切线高度 OA，新切线高度 OB；GRS 检验 OB 是否显著长于 OA

### 图注：GRS 检验几何图（图 2.11）怎么读

![[grs_fig211.png]]

- **蓝线 / 红线**：仅 K 因子 vs K+N 资产的有效前沿
- **σ=1 垂线**：在风险为 1 处画一条竖线
- **OA**：旧切点高度 = θ̂_K（仅因子的最大夏普比）
- **OB**：新切点高度 = θ̂_{N+K}（加入资产后的最大夏普比）
- **GRS 在检验**：OB 是否显著长于 OA → 新资产是否显著提升夏普比

---

### 4.2 Spanning 检验（公式 2.78-2.80）

| 检验 | 几何表达 | 含义 |
|:-----|:---------|:-----|
| **LR** | $\frac{T-K-N}{N}\left[\left(\frac{OD}{OC}\right)\left(\frac{AH}{BF}\right)-1\right]$ | 左端+右端联合 |
| **Wald** | $\left(\frac{OD}{OC}\right)^2-1 + \left(\frac{BE}{BF}\right)^2-1$ | 向外扩张 |
| **LM** | $1-\left(\frac{OC}{OD}\right)^2 + 1-\left(\frac{AG}{AH}\right)^2$ | 向内收缩 |

- $OD$ / $OC$：最小方差点风险比
- $AH$ / $BF$：渐近线斜率比
- Wald 和 LM 具有**完美对称性**

### 图注：Spanning 检验几何图（图 2.12）怎么读

![[spanning_fig212.png]]

**第一步：看两条实线**

| 图元 | 含义 |
|:-----|:-----|
| **蓝线** | 旧前沿：只用 K 个因子能达到的最优边界 |
| **红线** | 新前沿：加入 N 个资产后能达到的最优边界 |

红线在蓝线**左上方** → 新资产有独立价值，**不能张成**。

**第二步：看两个关键点 D 和 C**

| 点         | 含义                        |
| :-------- | :------------------------ |
| **D（蓝点）** | 旧前沿的**全局最小方差组合**，横坐标 = OD |
| **C（红点）** | 新前沿的**全局最小方差组合**，横坐标 = OC |

OC < OD → 新前沿的「最左端」更靠左，最小 achievable 风险变小。

**第三步：看两条虚线 AH 和 BF**

| 虚线 | 含义 |
|:-----|:-----|
| **蓝虚线 AH** | 从原点出发、与蓝前沿相切的直线，斜率 = 旧前沿的**最大夏普比** |
| **红虚线 BF** | 从原点出发、与红前沿相切的直线，斜率 = 新前沿的**最大夏普比** |

BF > AH → 新前沿的最大夏普比更高，高收益端也提升。

**Spanning 检验在比什么？**

- **左端**：OD vs OC（最小方差点的风险）
- **右端**：AH vs BF（渐近线斜率 = 最大夏普比）

若 OD/OC ≈ 1 且 AH/BF ≈ 1 → 前沿几乎重合 → **能张成**。  
若 OD > OC 且 BF > AH → 前沿外移 → **不能张成**（本图即此情形）。

---

## 5. 相关笔记

- [[因子暴露与因子收益]]
- [[Barra 多因子风险模型]]
